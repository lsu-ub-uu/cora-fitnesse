!contents -R2 -g -p -f -h
| import |
| se.uu.ub.cora.fitnesse |

!1 !-UserTest-!
A test that  reads all predefined metadata needed to be able to create a concrete recordType user

!2 Read predefined metadata to make sure it is correct
!***> Read metadataGroups for user (userNewGroup, userGroup)

!| RecordEndpointFixture |
| authToken | type | id | testReadRecord? | getStatusType? |
| $adminAuthToken | metadataGroup | userNewGroup | =~/"name":"linkedRecordId","value":"userIdTextVar".*"name":"linkedRecordId","value":"userFirstnameTextVar".*"name":"linkedRecordId","value":"userLastnameTextVar".*"name":"linkedRecordId","value":"userRoleRelationGroup".*"name":"linkedRecordId","value":"activeStatusCollectionVar"/ | OK |
| $adminAuthToken | metadataGroup | userGroup | =~/"name":"linkedRecordId","value":"userIdTextVar".*"name":"linkedRecordId","value":"userFirstnameTextVar".*"name":"linkedRecordId","value":"userLastnameTextVar".*"name":"linkedRecordId","value":"userRoleRelationGroup".*"name":"linkedRecordId","value":"activeStatusCollectionVar"/ | OK |

*!
!***> Read userGroupChild userRoleRelationGroup, and the descending children of that group

!| RecordEndpointFixture |
| authToken | type | id | testReadRecord? | getStatusType? |
| $adminAuthToken | metadataGroup | userRoleRelationGroup | =~/"name":"linkedRecordId","value":"userRoleLink".*"name":"linkedRecordId","value":"userRoleRulePartGroup"/ | OK |
| $adminAuthToken | metadataRecordLink | userRoleLink | =~/"name":"linkedRecordId","value":"permissionRole"/ | OK |
| $adminAuthToken | metadataGroup | userRoleRulePartGroup | =~/"name":"linkedRecordId","value":"permissionRulePartGroup"/ | OK |
| $adminAuthToken | metadataGroup | permissionRulePartGroup | | OK |
| $adminAuthToken | metadataTextVariable | permissionRulePartValueTextVar | | OK |

*!
!***> Read recordType (user)

!| RecordEndpointFixture |
| authToken | type | id | testReadRecord? | getStatusType? |
| $adminAuthToken | recordType | user | | OK |

*!
!2 Test with new user
!***> Create data of recordType user. Should fail since it is abstract

!| RecordEndpointFixture |
| authToken | type | id | json | testCreateRecord? | getStatusType? |
| $adminAuthToken | user | fitnessUser | {"name":"systemOneUserNewGroup","children":[{"name":"recordInfo","children":[{"name":"id","value":"fitnessUser"},{"name":"dataDivider","children":[{"name":"linkedRecordType","value":"system"},{"name":"linkedRecordId","value":"cora"}]}]},{"name":"userId","value":"user123"},{"name":"userFirstname","value":"Some"},{"name":"userLastname","value":"User"},{"name":"userRole","value":"","repeatId":"0"}]} | | METHOD_NOT_ALLOWED |

*!
