---
Static
---
# * '''Case 1''': An admin creating a record with no visibility value should set visibility to its default value (unpublished)
# * '''Case 2''': An admin creating a record with a visibility value should have this value in its data after creation
# * '''Case 3''': A user creating a record with no visibility value should set visibility to its default value (unpublished)
# * '''Case 4''': A user creating a record with a visibility value other than ''unpublished'' should behave according to permission
#
!***> '''Case 1''' Creating a record with no visibility value should set visibility to its default value (unpublished)
!define recordType {fitnesseRecordTypeWithVisibility}
!define case1CreateData {!-{"name":"fitnesseGroupWithRecordInfoVisibility","children":[{"name":"recordInfo","children":[{"name":"dataDivider","children":[{"name":"linkedRecordType","value":"system"},{"name":"linkedRecordId","value":"testSystem"}]},{"name":"validationType","children":[{"name":"linkedRecordType","value":"validationType"},{"name":"linkedRecordId","value":"fitnesseValidationTypeForRecordTypeWithVisibility"}]}]},{"name":"fitnesseTextVar","value":"en annan text"}]}-!}
!| ChildComparerFixture |
| authToken | type | json | testCreateAndStoreRecord? | getStatusType? | getCreatedId? |
| $adminAuthToken | ${recordType} | ${case1CreateData} | $createCase1ResponseBody= | ${expectedCreateResult} | $createCase1RecordId= |

!| script | ExtractSubstringUsingRegex |
| ensure | match found using text | $createCase1ResponseBody | and includes and not excludes | ${expectedCase1ResponseRegex} |

*!
!***> '''Case 2''' Creating a record with a visibility value should have this value in its data after creation
!define case2CreateData {!-{"name":"fitnesseGroupWithRecordInfoVisibility","children":[{"name":"recordInfo","children":[{"name":"dataDivider","children":[{"name":"linkedRecordType","value":"system"},{"name":"linkedRecordId","value":"testSystem"}]},{"name":"validationType","children":[{"name":"linkedRecordType","value":"validationType"},{"name":"linkedRecordId","value":"fitnesseValidationTypeForRecordTypeWithVisibility"}]},{"name":"visibility","value":"published"}]},{"name":"fitnesseTextVar","value":"en text"}]}-!}
!| ChildComparerFixture |
| authToken | type | json | testCreateAndStoreRecord? | getStatusType? | getCreatedId? |
| $adminAuthToken | ${recordType} | ${case2CreateData} | $createCase2ResponseBody= | ${expectedCreateResult} | $createCase2RecordId= |

#### NOTE: Save the original timestamp so it can be used to assert update does not change this value (this is used in the update tests)
#
!| script | ExtractSubstringUsingRegex |
| $createCase2TsVisibility= | get substring using text | $createCase2ResponseBody | and regex | "name":"tsVisibility","value":"\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}.\d{6}Z" |

!| script | ExtractSubstringUsingRegex |
| ensure | match found using text | $createCase2ResponseBody | and includes and not excludes | ${expectedCase2ResponseRegex} |

*!
!***> '''Case 3''' A user creating a record with no visibility value should set visibility to its default value (unpublished)
!define case3CreateData {!-{"name":"fitnesseGroupWithRecordInfoVisibility","children":[{"name":"recordInfo","children":[{"name":"dataDivider","children":[{"name":"linkedRecordType","value":"system"},{"name":"linkedRecordId","value":"testSystem"}]},{"name":"validationType","children":[{"name":"linkedRecordType","value":"validationType"},{"name":"linkedRecordId","value":"fitnesseValidationTypeForRecordTypeWithVisibility"}]}]},{"name":"fitnesseTextVar","value":"en annan text"}]}-!}
!| ChildComparerFixture |
| authToken | type | json | testCreateAndStoreRecord? | getStatusType? | getCreatedId? |
| $userAuthToken | ${recordType} | ${case3CreateData} | $createCase3ResponseBody= | ${expectedCreateResult} | $createCase3RecordId= |

!| script | ExtractSubstringUsingRegex |
| ensure | match found using text | $createCase3ResponseBody | and includes and not excludes | ${expectedCase3ResponseRegex} |

*!
!***> '''Case 4''' A user creating a record with a visibility value other than ''unpublished'' should have this value reverted to the default (unpublished)
!define case4CreateData {!-{"name":"fitnesseGroupWithRecordInfoVisibility","children":[{"name":"recordInfo","children":[{"name":"dataDivider","children":[{"name":"linkedRecordType","value":"system"},{"name":"linkedRecordId","value":"testSystem"}]},{"name":"validationType","children":[{"name":"linkedRecordType","value":"validationType"},{"name":"linkedRecordId","value":"fitnesseValidationTypeForRecordTypeWithVisibility"}]},{"name":"visibility","value":"published"}]},{"name":"fitnesseTextVar","value":"en text"}]}-!}
!| ChildComparerFixture |
| authToken | type | json | testCreateAndStoreRecord? | getStatusType? | getCreatedId? |
| $userAuthToken | ${recordType} | ${case4CreateData} | $createCase4ResponseBody= | ${expectedCreateResult} | $createCase4RecordId= |

!| script | ExtractSubstringUsingRegex |
| ensure | match found using text | $createCase4ResponseBody | and includes and not excludes | ${expectedCase4ResponseRegex} |

*!