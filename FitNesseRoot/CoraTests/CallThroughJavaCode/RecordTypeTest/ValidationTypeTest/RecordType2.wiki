---
Static
---
!2 Metadata
!3 Fält och begränsningar:
Manni write bla bl b

!4 ValidationType
 * validationType (group)
   * recordInfo (group, 1-1, '''noRestrictions''')
     * id (textVar, 1-1, '''noRestrictions ''')
     * type (link, 1-1, '''noRestrictions ''')
     * createdBy (link, 1-1, '''noRestrictions ''')
     * dataDivider (link, 1-1, '''noRestrictions ''')
     * tsCreated (textVar, 1-1, '''noRestrictions ''')
     * updated(group, 1-X, '''noRestrictions''')
     * validationType (link, 0-1, '''noRestrictions ''')
   * textId (link, 0-1, '''noRestrictions ''')
   * deftextId (link, 0-1, '''noRestrictions ''')  
   * metadataId (link, 1-1, '''noRestrictions ''')
   * newMetadataId (link, 1-1, '''noRestrictions ''')
   * presentationViewId (link, 1-1, '''noRestrictions ''')
   * presentationFormId (link, 1-1, '''noRestrictions ''')
   * newPresentationFormId (link, 1-1, '''noRestrictions ''')
   * menuPresentationViewId (link, 1-1, '''noRestrictions ''')
   * listPresentationViewId (link, 1-1, '''noRestrictions ''')
 
!3 !-RecordType-!
!***> Validation Type

!***> Read recordType validationType

!| RecordEndpointFixture |
| authToken | type | id | testReadRecord? | getStatusType? |
| $adminAuthToken | recordType | validationType | | OK |

*!
Read metadataGroup for new validationType and validate it has the correct children

!***> Validate children for validationTypeNewGroup

Read the metadatagroup for later validation

!| RecordEndpointFixture |
| type | id | testReadRecordAndStoreJson? |
| metadataGroup | validationTypeNewGroup | |

Validate children

!| ChildComparerFixture |
| expectedNumberOfChildren | testCheckNumberOfChildren? |
| 10 | OK |

!| MetadataLinkFixture |
| authToken | linkedRecordType | linkedRecordId | getRepeatMin? | getRepeatMax? | getNameInData? | getRecordPartConstraint? |
| $adminAuthToken | metadataGroup | recordInfoNewGroup | 1 | 1 | recordInfo | noRestrictions |
| $adminAuthToken | coraText | validateTypeText | 1 | 1 | textId | noRestrictions |
| $adminAuthToken | coraText | validateTypeDefText | 1 | 1 | defTextId | noRestrictions |


*!
!***> Validate recordInfoNewGroup

Read

!| RecordEndpointFixture |
| type | id | testReadRecordAndStoreJson? |
| metadataGroup | recordInfoNewGroup | |

Kontrollera barnen

!| ChildComparerFixture |
| expectedNumberOfChildren | testCheckNumberOfChildren? |
| 1 | OK |

!| MetadataLinkFixture |
| authToken | linkedRecordType | linkedRecordId | getRepeatMin? | getRepeatMax? | getNameInData? | getRecordPartConstraint? |
| $adminAuthToken | metadataRecordLink | dataDividerDivaLink | 1 | 1 | dataDivider | noRestrictions |

*!
Läs topnivå metadatagruppen för en '''befintlig''' person, och kontrollera att den har rätt barn

!***> Kontrollera barnen till personGroup

Läs in metadatagruppen för senare kontroll

!| RecordEndpointFixture |
| type | id | testReadRecordAndStoreJson? |
| metadataGroup | personGroup | |

Kontrollera barnen

!| ChildComparerFixture |
| expectedNumberOfChildren | testCheckNumberOfChildren? |
| 15 | OK |

!| MetadataLinkFixture |
| authToken | linkedRecordType | linkedRecordId | getRepeatMin? | getRepeatMax? | getNameInData? | getRecordPartConstraint? |
| $adminAuthToken | metadataGroup | recordInfoPersonDivaGroup | 1 | 1 | recordInfo | noRestrictions |
| $adminAuthToken | metadataGroup | personNameGroup | 1 | 1 | authorisedName | noRestrictions |
| $adminAuthToken | metadataTextVariable | personAcademicTitleTextVar | 0 | 1 | academicTitle | readWrite |
| $adminAuthToken | metadataTextVariable | yearOfBirthTextVar | 0 | 1 | yearOfBirth | readWrite |
| $adminAuthToken | metadataTextVariable | yearOfDeathTextVar | 0 | 1 | yearOfDeath | readWrite |
| $adminAuthToken | metadataTextVariable | personEmailTextVar | 0 | 1 | emailAddress | readWrite |
| $adminAuthToken | metadataGroup | personAlternativeNameGroup | 0 | X | alternativeName | readWrite |
| $adminAuthToken | metadataGroup | personURLGroup | 0 | X | externalURL | readWrite |
| $adminAuthToken | metadataRecordLink | personDomainPartLink | 0 | X | personDomainPart | readWrite |
| $adminAuthToken | metadataGroup | personOtherAffiliationGroup | 0 | X | otherAffiliation | readWrite |
| $adminAuthToken | metadataTextVariable | personORCIDValueTextVar | 0 | X | ORCID_ID | readWrite |
| $adminAuthToken | metadataTextVariable | personVIAFValueTextVar | 0 | X | VIAF_ID | readWrite |
| $adminAuthToken | metadataTextVariable | personLibrisValueTextVar | 0 | X | Libris_ID | readWrite |
| $adminAuthToken | metadataGroup | personBiographyEnglishGroup | 0 | 1 | biographyEnglish | readWrite |
| $adminAuthToken | metadataGroup | personBiographySwedishGroup | 0 | 1 | biographySwedish | readWrite |

*!
Läst in metadatagruppen recordInfoPersonDivaGroup för senare kontroll

!***> Kontrollera recordInfoPersonDivaGroup

Läs in

!| RecordEndpointFixture |
| type | id | testReadRecordAndStoreJson? |
| metadataGroup | recordInfoPersonDivaGroup | |

Kontrollera barnen

!| ChildComparerFixture |
| expectedNumberOfChildren | testCheckNumberOfChildren? |
| 8 | OK |

!| MetadataLinkFixture |
| authToken | linkedRecordType | linkedRecordId | getRepeatMin? | getRepeatMax? | getNameInData? | getRecordPartConstraint? |
| $adminAuthToken | metadataTextVariable | idTextVar | 1 | 1 | id | write |
| $adminAuthToken | metadataRecordLink | recordTypeLink | 1 | 1 | type | write |
| $adminAuthToken | metadataRecordLink | createdByLink | 1 | 1 | createdBy | readWrite |
| $adminAuthToken | metadataRecordLink | dataDividerDivaLink | 1 | 1 | dataDivider | write |
| $adminAuthToken | metadataTextVariable | tsCreatedTextVar | 1 | 1 | tsCreated | write |
| $adminAuthToken | metadataGroup | updatedGroup | 1 | X | updated | readWrite |
| $adminAuthToken | metadataCollectionVariable | personPublicCollectionVar | 1 | 1 | public | readWrite |
| $adminAuthToken | metadataCollectionVariable | domainCollectionVar | 0 | X | domain | readWrite |

*!
!***> Kontrollera updated

Läs in

!| RecordEndpointFixture |
| type | id | testReadRecordAndStoreJson? |
| metadataGroup | updatedGroup | |

Kontrollera barnen

!| ChildComparerFixture |
| expectedNumberOfChildren | testCheckNumberOfChildren? |
| 2 | OK |

!| MetadataLinkFixture |
| authToken | linkedRecordType | linkedRecordId | getRepeatMin? | getRepeatMax? | getNameInData? | getRecordPartConstraint? |
| $adminAuthToken | metadataRecordLink | updatedByLink | 1 | 1 | updatedBy | noRestrictions |
| $adminAuthToken | metadataTextVariable | tsUpdatedTextVar | 1 | 1 | tsUpdated | noRestrictions |

*!
!***> Kontrollera authorisedName

Läs in

!| RecordEndpointFixture |
| type | id | testReadRecordAndStoreJson? |
| metadataGroup | personNameGroup | |

Kontrollera barnen

!| ChildComparerFixture |
| expectedNumberOfChildren | testCheckNumberOfChildren? |
| 2 | OK |

!| MetadataLinkFixture |
| authToken | linkedRecordType | linkedRecordId | getRepeatMin? | getRepeatMax? | getNameInData? | getRecordPartConstraint? |
| $adminAuthToken | metadataTextVariable | firstNameTextVar | 0 | 1 | givenName | noRestrictions |
| $adminAuthToken | metadataTextVariable | lastNameTextVar | 0 | 1 | familyName | noRestrictions |

*!
!***> Kontrollera alternativeName

Läs in

!| RecordEndpointFixture |
| type | id | testReadRecordAndStoreJson? |
| metadataGroup | personAlternativeNameGroup | |

Kontrollera barnen

!| ChildComparerFixture |
| expectedNumberOfChildren | testCheckNumberOfChildren? |
| 2 | OK |

!| MetadataLinkFixture |
| authToken | linkedRecordType | linkedRecordId | getRepeatMin? | getRepeatMax? | getNameInData? | getRecordPartConstraint? |
| $adminAuthToken | metadataTextVariable | firstNameTextVar | 0 | 1 | givenName | noRestrictions |
| $adminAuthToken | metadataTextVariable | lastNameTextVar | 0 | 1 | familyName | noRestrictions |

*!
!***> Kontrollera externalURL

Läs in

!| RecordEndpointFixture |
| type | id | testReadRecordAndStoreJson? |
| metadataGroup | personURLGroup | |

Kontrollera barnen

!| ChildComparerFixture |
| expectedNumberOfChildren | testCheckNumberOfChildren? |
| 2 | OK |

!| MetadataLinkFixture |
| authToken | linkedRecordType | linkedRecordId | getRepeatMin? | getRepeatMax? | getNameInData? | getRecordPartConstraint? |
| $adminAuthToken | metadataTextVariable | personExternalURLLabelTextVar | 1 | 1 | linkTitle | noRestrictions |
| $adminAuthToken | metadataTextVariable | personExternalURLTextVar | 1 | 1 | URL | noRestrictions |

*!
!***> Kontrollera otherAffiliation

Läs in

!| RecordEndpointFixture |
| type | id | testReadRecordAndStoreJson? |
| metadataGroup | personOtherAffiliationGroup | |

Kontrollera barnen

!| ChildComparerFixture |
| expectedNumberOfChildren | testCheckNumberOfChildren? |
| 3 | OK |

!| MetadataLinkFixture |
| authToken | linkedRecordType | linkedRecordId | getRepeatMin? | getRepeatMax? | getNameInData? | getRecordPartConstraint? |
| $adminAuthToken | metadataTextVariable | personOtherAffiliationTextVar | 1 | 1 | affiliation | noRestrictions |
| $adminAuthToken | metadataTextVariable | personAffiliationFromTextVar | 0 | 1 | affiliationFromYear | noRestrictions |
| $adminAuthToken | metadataTextVariable | personAffiliationUntilTextVar | 0 | 1 | affiliationUntilYear | noRestrictions |

*!
!***> Kontrollera biographyEnglish

Läs in

!| RecordEndpointFixture |
| type | id | testReadRecordAndStoreJson? |
| metadataGroup | personBiographyEnglishGroup | |

Kontrollera barnen

!| ChildComparerFixture |
| expectedNumberOfChildren | testCheckNumberOfChildren? |
| 2 | OK |

!| MetadataLinkFixture |
| authToken | linkedRecordType | linkedRecordId | getRepeatMin? | getRepeatMax? | getNameInData? | getRecordPartConstraint? |
| $adminAuthToken | metadataCollectionVariable | engLanguageCollectionVar | 1 | 1 | language | noRestrictions |
| $adminAuthToken | metadataTextVariable | personBiographyTextVar | 1 | 1 | biography | noRestrictions |

*!
!***> Kontrollera biographySwedish

Läs in

!| RecordEndpointFixture |
| type | id | testReadRecordAndStoreJson? |
| metadataGroup | personBiographySwedishGroup | |

Kontrollera barnen

!| ChildComparerFixture |
| expectedNumberOfChildren | testCheckNumberOfChildren? |
| 2 | OK |

!| MetadataLinkFixture |
| authToken | linkedRecordType | linkedRecordId | getRepeatMin? | getRepeatMax? | getNameInData? | getRecordPartConstraint? |
| $adminAuthToken | metadataCollectionVariable | sweLanguageCollectionVar | 1 | 1 | language | noRestrictions |
| $adminAuthToken | metadataTextVariable | personBiographyTextVar | 1 | 1 | biography | noRestrictions |

*!
*!
!***> !-PersonDomainPart-!

!| RecordEndpointFixture |
| authToken | type | id | testReadRecord? | getStatusType? |
| $adminAuthToken | recordType | personDomainPart | | OK |

Läs topnivå metadatagruppen för en '''ny''' person, och kontrollera att den har rätt barn

!***> Kontrollera barnen till  personDomainPartNewGroup

Läs in metadatagruppen för senare kontroll

!| RecordEndpointFixture |
| type | id | testReadRecordAndStoreJson? |
| metadataGroup | personDomainPartNewGroup | |

Kontrollera barnen

!| ChildComparerFixture |
| expectedNumberOfChildren | testCheckNumberOfChildren? |
| 4 | OK |

!| MetadataLinkFixture |
| authToken | linkedRecordType | linkedRecordId | getRepeatMin? | getRepeatMax? | getNameInData? | getRecordPartConstraint? |
| $adminAuthToken | metadataGroup | recordInfoAutogeneratedDomainNewGroup | 1 | 1 | recordInfo | noRestrictions |
| $adminAuthToken | metadataRecordLink | personLink | 1 | 1 | personLink | noRestrictions |
| $adminAuthToken | metadataTextVariable | personLocalValueTextVar | 0 | X | identifier | noRestrictions |
| $adminAuthToken | metadataGroup | personAffiliationGroup | 0 | X | affiliation | noRestrictions |

Kontrollera recordInfo

!| RecordEndpointFixture |
| type | id | testReadRecordAndStoreJson? |
| metadataGroup | recordInfoAutogeneratedDomainNewGroup | |

!| ChildComparerFixture |
| expectedNumberOfChildren | testCheckNumberOfChildren? |
| 2 | OK |

!| MetadataLinkFixture |
| authToken | linkedRecordType | linkedRecordId | getRepeatMin? | getRepeatMax? | getNameInData? | getRecordPartConstraint? |
| $adminAuthToken | metadataRecordLink | dataDividerDivaLink | 1 | 1 | dataDivider | noRestrictions |
| $adminAuthToken | metadataCollectionVariable | domainCollectionVar | 1 | 1 | domain | noRestrictions |

*!
Läs topnivå metadatagruppen för en '''befintlig''' person, och kontrollera att den har rätt barn

!***> Kontrollera barnen till personDomainPartGroup

Läs in metadatagruppen för senare kontroll

!| RecordEndpointFixture |
| type | id | testReadRecordAndStoreJson? |
| metadataGroup | personDomainPartGroup | |

Kontrollera barnen

!| ChildComparerFixture |
| expectedNumberOfChildren | testCheckNumberOfChildren? |
| 3 | OK |

!| MetadataLinkFixture |
| authToken | linkedRecordType | linkedRecordId | getRepeatMin? | getRepeatMax? | getNameInData? | getRecordPartConstraint? |
| $adminAuthToken | metadataGroup | recordInfoWithDomainGroup | 1 | 1 | recordInfo | noRestrictions |
| $adminAuthToken | metadataTextVariable | personLocalValueTextVar | 0 | X | identifier | readWrite |
| $adminAuthToken | metadataGroup | personAffiliationGroup | 0 | X | affiliation | noRestrictions |

Kontrollera recordInfo

!| RecordEndpointFixture |
| type | id | testReadRecordAndStoreJson? |
| metadataGroup | recordInfoWithDomainGroup | |

!| ChildComparerFixture |
| expectedNumberOfChildren | testCheckNumberOfChildren? |
| 8 | OK |

!| MetadataLinkFixture |
| authToken | linkedRecordType | linkedRecordId | getRepeatMin? | getRepeatMax? | getNameInData? | getRecordPartConstraint? |
| $adminAuthToken | metadataTextVariable | idTextVar | 1 | 1 | id | write |
| $adminAuthToken | metadataRecordLink | recordTypeLink | 1 | 1 | type | write |
| $adminAuthToken | metadataRecordLink | createdByLink | 1 | 1 | createdBy | readWrite |
| $adminAuthToken | metadataRecordLink | dataDividerDivaLink | 1 | 1 | dataDivider | write |
| $adminAuthToken | metadataTextVariable | tsCreatedTextVar | 1 | 1 | tsCreated | write |
| $adminAuthToken | metadataGroup | updatedGroup | 1 | X | updated | readWrite |
| $adminAuthToken | metadataCollectionVariable | personPublicCollectionVar | 1 | 1 | public | readWrite |
| $adminAuthToken | metadataCollectionVariable | domainCollectionVar | 1 | 1 | domain | readWrite |

*!
!***> Kontrollera affiliation

Läs in

!| RecordEndpointFixture |
| type | id | testReadRecordAndStoreJson? |
| metadataGroup | personAffiliationGroup | |

Kontrollera barnen

!| ChildComparerFixture |
| expectedNumberOfChildren | testCheckNumberOfChildren? |
| 3 | OK |

!| MetadataLinkFixture |
| authToken | linkedRecordType | linkedRecordId | getRepeatMin? | getRepeatMax? | getNameInData? | getRecordPartConstraint? |
| $adminAuthToken | metadataRecordLink | divaOrganisationLink | 1 | 1 | organisationLink | noRestrictions |
| $adminAuthToken | metadataTextVariable | personAffiliationFromTextVar | 0 | 1 | affiliationFromYear | noRestrictions |
| $adminAuthToken | metadataTextVariable | personAffiliationUntilTextVar | 0 | 1 | affiliationUntilYear | noRestrictions |

*!
*!
!3 Roller
Notera att rättigheterna som kontrolleras i det här avsnittet gäller, vilka rättigheter man har på postTypen inte enstaka poster. Rättigheterna för enstaka poster kontrolleras under de olika testerna för rättigheter så som read, update, etc.

!4 !-SystemAdmin-!
!-SystemAdmin har tillgång till validate, list och search för person postTypen-!

!style_red[Validate och batch_index för personpost är inte implementerade än, därför finns de med i expectedPermissionResult ]
!***> Kontrollera de actions systemAdmin får med i recordType för person
!define currentAuthToken {$systemAdminAuthToken}
!define currentRecordType {person}
!define expectedPermissionResult {Action update is missing. Action delete is missing. Action index is missing. Action create is missing. Action validate is missing. Action batch_index is missing.}
!include -seamless .TheDiVATests.DivaTests.checkActionsForRecordType
*!
!***> Kontrollera de actions systemAdmin får med i recordType för personDomainPart
!define currentAuthToken {$systemAdminAuthToken}
!define currentRecordType {personDomainPart}
!define expectedPermissionResult {Action update is missing. Action delete is missing. Action index is missing. Action validate is missing. Action batch_index is missing.}
#!define expectedPermissionResult {Action update is missing. Action delete is missing. Action index is missing. Action batch_index is missing.}
!include -seamless .TheDiVATests.DivaTests.checkActionsForRecordType
*!
!4 !-DomainAdmin-!
!-DomainAdmin har tillgång till validate och search för person  postTypen-!

!***> Kontrollera de actions domainAdmin får med i recordType för person
!define currentAuthToken {$domainAdminUUAuthToken}
!define currentRecordType {person}
!define expectedPermissionResult {Action update is missing. Action delete is missing. Action index is missing. Action create is missing. Action validate is missing. Action list is missing. Action batch_index is missing.}
!include -seamless .TheDiVATests.DivaTests.checkActionsForRecordType
*!
!***> Kontrollera de actions domainAdmin får med i recordType för personDomainPart
!define currentAuthToken {$domainAdminUUAuthToken}
!define currentRecordType {personDomainPart}
!define expectedPermissionResult {Action update is missing. Action delete is missing. Action index is missing. Action validate is missing. Action list is missing. Action batch_index is missing.}
!include -seamless .TheDiVATests.DivaTests.checkActionsForRecordType
*!
!4 !-Guest-!
!-Guest har tillgång till search för person postTypen-!

!***> Kontrollera de actions guest får med i recordType för person
!define currentAuthToken {$guestToken}
!define currentRecordType {person}
!define expectedPermissionResult {Action update is missing. Action delete is missing. Action index is missing. Action create is missing. Action validate is missing. Action list is missing. Action batch_index is missing.}
!include -seamless .TheDiVATests.DivaTests.checkActionsForRecordType
*!
!***> Kontrollera de actions guest får med i recordType för personDomainPart
!define currentAuthToken {$guestToken}
!define currentRecordType {personDomainPart}
!define expectedPermissionResult {Action update is missing. Action delete is missing. Action index is missing. Action create is missing. Action validate is missing. Action list is missing. Action batch_index is missing.}
!include -seamless .TheDiVATests.DivaTests.checkActionsForRecordType
*!
